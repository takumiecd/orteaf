schema_version: "1.0"

devices:
  - id: "CudaGeneric"
    display_name: "Generic CUDA Device"
    execution: "Cuda"
    architecture: "Generic"
    memory:
      max_bytes: 4294967296   # 4 GiB
      shared_bytes: 49152
    supported_dtypes: ["F32", "F16"]
    supported_ops: ["Add", "MatMul", "Relu"]
    capabilities:
      compute_capability: "sm50"
      tensor_cores: "false"
    notes: "フォールバック用のCUDAデバイス定義"

  - id: "CudaH100Pcie80GB"
    display_name: "H100 PCIe (80GB)"
    execution: "Cuda"
    architecture: "Sm90"
    memory:
      max_bytes: 85899345920   # 80 GiB
      shared_bytes: 229376
    supported_dtypes: ["F32", "F16", "F8E4M3", "F8E5M2"]
    supported_ops: ["Add", "MatMul", "Relu", "CustomQuantize"]
    capabilities:
      compute_capability: "sm90"
      tensor_cores: "true"
      pcie_bandwidth_gbps: "128"
    notes: "CUDA 12.2 以上の環境を推奨"

  - id: "CudaRtx3070"
    display_name: "GeForce RTX 3070"
    execution: "Cuda"
    architecture: "Sm86"
    memory:
      max_bytes: 8589934592    # 8 GiB
      shared_bytes: 102400
    supported_dtypes: ["F32", "F16", "F8E4M3", "F8E5M2"]
    supported_ops: ["Add", "MatMul", "Relu", "CustomQuantize"]
    capabilities:
      compute_capability: "sm86"
      tensor_cores: "true"
      memory_type: "GDDR6"
    notes: "Desktop Ampere GPU"

  - id: "MpsGeneric"
    display_name: "Generic MPS Device"
    execution: "Mps"
    architecture: "Generic"
    memory:
      max_bytes: 2147483648   # 2 GiB
    supported_dtypes: ["F32"]
    supported_ops: ["Add", "Relu"]
    capabilities:
      metal_version: "3.0"

  - id: "MpsM3Max40c"
    display_name: "M3 Max (40-core GPU)"
    execution: "Mps"
    architecture: "M3"
    memory:
      max_bytes: 34359738368   # 32 GiB
    supported_dtypes: ["F32", "F16"]
    supported_ops: ["Add", "MatMul", "Relu", "CustomQuantize"]
    capabilities:
      metal_version: "3.1"
      supports_attention: "true"

  - id: "MpsM4Pro"
    display_name: "M4 Pro (Integrated GPU)"
    execution: "Mps"
    architecture: "M4"
    memory:
      max_bytes: 25769803776   # 24 GiB
    supported_dtypes: ["F32", "F16"]
    supported_ops: ["Add", "MatMul", "Relu", "CustomQuantize"]
    capabilities:
      metal_version: "3.2"
      neural_engine_accel: "true"
    notes: "Apple Silicon M4 Pro unified memory GPU"

  - id: "CpuGeneric"
    display_name: "Generic CPU"
    execution: "Cpu"
    architecture: "Generic"
    memory:
      max_bytes: 17179869184   # 16 GiB
    supported_dtypes: ["F32", "F64", "I32", "I64"]
    supported_ops: ["Add", "MatMul", "Relu", "SpikeThreshold"]
    capabilities:
      isa: "SSE4.2"

  - id: "CpuZen4"
    display_name: "Zen 4 (AVX-512)"
    execution: "Cpu"
    architecture: "Zen4"
    memory:
      max_bytes: 34359738368   # 32 GiB
    supported_dtypes: ["F32", "F64", "F16"]
    supported_ops: ["Add", "MatMul", "Relu", "SpikeThreshold", "CustomQuantize"]
    capabilities:
      isa: "AVX-512 + BF16"
